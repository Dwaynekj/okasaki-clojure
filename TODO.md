* Better error checking and more tests


